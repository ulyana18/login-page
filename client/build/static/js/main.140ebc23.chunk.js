(this["webpackJsonpauthorize-app"]=this["webpackJsonpauthorize-app"]||[]).push([[0],{121:function(e,t,a){e.exports=a(167)},126:function(e,t,a){},128:function(e,t,a){},134:function(e,t,a){},163:function(e,t){},167:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(10),i=a.n(r),o=(a(126),a(16)),c=a.n(o),l=a(21),u=a(23),m=a(24),p=a(28),h=a(26),d=(a(128),a(104)),g=a(11),f=a(203),w=a(208),v=a(201),S=a(75),b=a(212),E=a(205),k=a(204),C=a(37),I=a(215),N=a(209),y=a(211),A=a(213),T=a(202);function O(e,t,a){return P.apply(this,arguments)}function P(){return(P=Object(l.a)(c.a.mark((function e(t,a,n){var s,r,i,o,l=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=l.length>3&&void 0!==l[3]?l[3]:"",r="login"===t,e.prev=2,e.next=5,fetch("/api/user/".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{name:s,email:a,password:n}})});case 5:return i=e.sent,e.next=8,i.json();case 8:if(o=e.sent,401!==i.status){e.next=15;break}return window.localStorage.removeItem("userName"),window.localStorage.removeItem("userEmail"),window.localStorage.removeItem("token"),window.localStorage.removeItem("refreshToken"),e.abrupt("return",!1);case 15:return window.localStorage.setItem("userName",o.user),window.localStorage.setItem("userEmail",o.email),window.localStorage.setItem("token",o.token),window.localStorage.setItem("refreshToken",o.refreshToken),e.abrupt("return",!0);case 22:e.prev=22,e.t0=e.catch(2),r?alert("Incorrect login or password"):alert("This email is already in use!");case 25:case"end":return e.stop()}}),e,null,[[2,22]])})))).apply(this,arguments)}function x(){return(x=Object(l.a)(c.a.mark((function e(){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/user/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{accessToken:window.localStorage.getItem("token"),name:window.localStorage.getItem("userName"),email:window.localStorage.getItem("userEmail"),refreshToken:window.localStorage.getItem("refreshToken")}})});case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,401!==t.status&&window.localStorage.setItem("token",a.accessToken),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("acces token died");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}var j=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).passwordCheck=function(e){n.passwordInput=e.target.value;var t=!/^(?!\s*$).+/.test(e.target.value);n.setState({isPasswordEmpty:t},(function(){this.checkSubmitDisable()}))},n.emailCheck=function(e){n.emailInput=e.target.value;var t=!/^(?!\s*$).+/.test(e.target.value);n.setState({isEmailEmpty:t},(function(){this.checkSubmitDisable()}))},n.checkSubmitDisable=function(){var e=!1===n.state.isPasswordEmpty&&!1===n.state.isEmailEmpty;n.setState({isDisabled:!e})},n.passwordInput="",n.emailInput="",n.state={isPasswordEmpty:null,isEmailEmpty:null,isDisabled:!0,isLoggedIn:null,isSpinning:!1},n.logIn=n.logIn.bind(Object(C.a)(n)),n}return Object(m.a)(a,[{key:"logIn",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isSpinning:!0}),e.next=3,O("login",this.emailInput,this.passwordInput);case 3:t=e.sent,setTimeout((function(){a.setState({isLoggedIn:t,isSpinning:!1})}),500),setTimeout((function(){a.props.updateState({isAuth:t})}),1200);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement("form",{className:"login-form",noValidate:!0,autoComplete:"on"},s.a.createElement(I.a,{open:this.state.isLoggedIn,autoHideDuration:3e3,onClose:function(){return e.setState({isLoggedIn:null})},anchorOrigin:{vertical:"top",horizontal:"center"}},s.a.createElement(A.a,{severity:"success"},"You are logged in!")),s.a.createElement(I.a,{open:!1===this.state.isLoggedIn,autoHideDuration:3e3,onClose:function(){return e.setState({isLoggedIn:null})},anchorOrigin:{vertical:"top",horizontal:"center"}},s.a.createElement(A.a,{severity:"error"},"Incorrect login or password!")),s.a.createElement(N.a,{required:!0,id:"email",label:"Email",type:"email",onChange:this.emailCheck}),s.a.createElement(N.a,{required:!0,id:"password",label:"Password",type:"password",autoComplete:"current-password",onChange:this.passwordCheck}),s.a.createElement(y.a,{m:2},s.a.createElement(v.a,{disabled:this.state.isDisabled,onClick:this.logIn,className:"logInBtn",variant:"outlined"},this.state.isSpinning&&s.a.createElement(T.a,{size:20}),!this.state.isSpinning&&s.a.createElement("span",null,"Log In"))))}}]),a}(n.Component),D=a(217),F=a(216),U=a(72),V=a.n(U),z=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).nameCheck=function(e){if(n.nameInput=e.target.value,n.state.isFirstTime){var t=!n.regexpFirst.test(e.target.value);n.setState({isNotCorrectName:t},(function(){this.checkSubmitDisable()}))}else n.nameValidate()},n.emailCheck=function(e){if(n.emailInput=e.target.value,n.state.isFirstTime){var t=!n.regexpFirst.test(e.target.value);n.setState({isNotCorrectEmail:t},(function(){this.checkSubmitDisable()}))}else n.emailValidate()},n.passwordCheck=function(e){if(n.passwordInput=e.target.value,n.state.isFirstTime){var t=!n.regexpFirst.test(e.target.value);n.setState({isNotCorrectPassword:t},(function(){this.checkSubmitDisable()}))}else n.passwordValidate()},n.confirmPasswordCheck=function(e){if(n.confirmPasswordInput=e.target.value,n.state.isFirstTime){var t=!n.regexpFirst.test(e.target.value);n.setState({isNotCorrectConfirmPassword:t},(function(){this.checkSubmitDisable()}))}else n.confirmPasswordValidate()},n.nameValidate=function(){var e=/^[a-zA-Z]+$/.test(n.nameInput);n.setState({isNotCorrectName:!e},(function(){this.checkSubmitDisable()}))},n.emailValidate=function(){var e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n.emailInput);n.setState({isNotCorrectEmail:!e},(function(){this.checkSubmitDisable()}))},n.passwordValidate=function(){var e=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(n.passwordInput);n.setState({isNotCorrectPassword:!e},(function(){this.checkSubmitDisable()}))},n.confirmPasswordValidate=function(e){var t=n.confirmPasswordInput===n.passwordInput;n.setState({isNotCorrectConfirmPassword:!t},(function(){this.checkSubmitDisable()}))},n.checkSubmitDisable=function(){var e=!1===n.state.isNotCorrectName&&!1===n.state.isNotCorrectEmail&&!1===n.state.isNotCorrectPassword&&!1===n.state.isNotCorrectConfirmPassword;return n.setState({isDisabled:!e}),e},n.regexpFirst=/^(?!\s*$).+/,n.nameInput="",n.passwordInput="",n.emailInput="",n.confirmPasswordInput="",n.state={isNotCorrectName:null,isNotCorrectEmail:null,isNotCorrectPassword:null,isNotCorrectConfirmPassword:null,isDisabled:!0,isSignedUp:null,isSpinning:!1,isFirstTime:!0},n.signUp=n.signUp.bind(Object(C.a)(n)),n}return Object(m.a)(a,[{key:"signUp",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.nameValidate();case 2:return e.next=4,this.emailValidate();case 4:return e.next=6,this.passwordValidate();case 6:return e.next=8,this.confirmPasswordValidate();case 8:return e.next=10,this.checkSubmitDisable();case 10:if(!e.sent){e.next=20;break}return this.setState({isSpinning:!0,isFirstTime:!0}),e.next=15,O("signup",this.emailInput,this.passwordInput,this.nameInput);case 15:t=e.sent,setTimeout((function(){a.setState({isSignedUp:t,isSpinning:!1})}),500),setTimeout((function(){a.props.updateState({isAuth:t})}),1200),e.next=21;break;case 20:this.setState({isFirstTime:!1});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement("form",{className:"signup-form",noValidate:!0,autoComplete:"on"},s.a.createElement(I.a,{open:this.state.isSignedUp,autoHideDuration:3e3,onClose:function(){return e.setState({isSignedUp:null})},anchorOrigin:{vertical:"top",horizontal:"center"}},s.a.createElement(A.a,{severity:"success"},"You are signed up!")),s.a.createElement(I.a,{open:!1===this.state.isSignedUp,autoHideDuration:3e3,onClose:function(){return e.setState({isSignedUp:null})},anchorOrigin:{vertical:"top",horizontal:"center"}},s.a.createElement(A.a,{severity:"error"},"This email is already in use!")),s.a.createElement(N.a,{required:!0,error:this.state.isNotCorrectName&&!this.state.isFirstTime,id:"name",label:"Name",onChange:this.nameCheck,helperText:!(!this.state.isNotCorrectName||this.state.isFirstTime)&&"Use only alphabet characters"}),s.a.createElement(N.a,{required:!0,error:this.state.isNotCorrectEmail&&!this.state.isFirstTime,id:"email",label:"Email",type:"email",onChange:this.emailCheck,helperText:!(!this.state.isNotCorrectEmail||this.state.isFirstTime)&&"Incorrect email"}),s.a.createElement(N.a,{required:!0,error:this.state.isNotCorrectPassword&&!this.state.isFirstTime,id:"password",label:"Password",type:"password",autoComplete:"current-password",InputProps:{endAdornment:s.a.createElement(D.a,{position:"end"},s.a.createElement(F.a,{title:"Password must contain minimum 8 characters, at least 1 letter and 1 number"},s.a.createElement(V.a,null)))},onChange:this.passwordCheck,helperText:!(!this.state.isNotCorrectPassword||this.state.isFirstTime)&&"Password must contain minimum 8 characters, at least 1 letter and 1 number"}),s.a.createElement(N.a,{required:!0,error:this.state.isNotCorrectConfirmPassword&&!this.state.isFirstTime,id:"standard-password",label:"Confirm password",type:"password",InputProps:{endAdornment:s.a.createElement(D.a,{position:"end"},s.a.createElement(F.a,{title:"Password and confirm password must match"},s.a.createElement(V.a,null)))},onChange:this.confirmPasswordCheck,helperText:!(!this.state.isNotCorrectConfirmPassword||this.state.isFirstTime)&&"Password and confirm password don't match!"}),s.a.createElement(y.a,{m:2},s.a.createElement(v.a,{disabled:this.state.isDisabled,onClick:this.signUp,className:"signUpBtn",variant:"outlined",id:"signUpButton"},this.state.isSpinning&&s.a.createElement(T.a,{size:20}),!this.state.isSpinning&&s.a.createElement("span",null,"Sign Up"))))}}]),a}(n.Component),L=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).setAppState=function(){var e=Object(l.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),a=t.isAuth,n.setState({isAuthenticated:a}),n.props.updateState({isAuth:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={value:localStorage.getItem("page")?localStorage.getItem("page"):"1",isAuthenticated:!1},n}return Object(m.a)(a,[{key:"handleChange",value:function(e,t){this.setState({value:t}),window.localStorage.setItem("page",t)}},{key:"render",value:function(){return s.a.createElement("div",{className:"tabWrapper"},s.a.createElement(S.a,{style:"backgroundColor: #cbecec",value:this.state.value},s.a.createElement(f.a,{position:"static"},s.a.createElement(b.a,{onChange:this.handleChange.bind(this),"aria-label":"simple tabs example"},s.a.createElement(k.a,{label:"Sign Up",value:"1"}),s.a.createElement(k.a,{label:"Log In",value:"2"}))),s.a.createElement(E.a,{value:"1"},s.a.createElement(z,{updateState:this.setAppState})),s.a.createElement(E.a,{value:"2"},s.a.createElement(j,{updateState:this.setAppState}))))}}]),a}(n.Component),M=a(105),W=(a(134),a(199)),B=a(206),$=a(207),q=a(103),H=a.n(q).a.connect("https://login-page-ulyana18.herokuapp.com/"),Z=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).onMessageSubmit=function(){H.emit("chat message",n.chatInput.current.value,window.localStorage.getItem("userName"),window.localStorage.getItem("userEmail")),n.setState({message:""}),n.chatInput.current.value=""},n.getDataFromDB=function(){H.emit("get database")},n.handleKeyDown=function(e){"Enter"===e.key&&n.onMessageSubmit()},n.state={message:"",chat:[]},n.chatInput=s.a.createRef(),n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;H.on("chat message",(function(t){var a=t.message,n=t.name,s=t.email;e.setState({chat:[].concat(Object(M.a)(e.state.chat),[{message:a,name:n,email:s}])},(function(){console.log(this.state)}))})),H.on("get database",(function(t){e.setState({chat:t},(function(){console.log(this.state)}))})),H.emit("get database")}},{key:"renderChat",value:function(){return this.state.chat.map((function(e,t){var a=e.message,n=e.name,r=e.email;return s.a.createElement("div",{className:r===window.localStorage.getItem("userEmail")?"messageWrapper messageWrapper-myMessage":"messageWrapper messageWrapper-otherMessage"},s.a.createElement("div",{className:r===window.localStorage.getItem("userEmail")?"myMessage message":"otherMessage message"},s.a.createElement("span",{className:"userName"},n),s.a.createElement("span",{className:"userEmail"},a)),s.a.createElement("div",{className:"messageAvatar"},s.a.createElement(B.a,null)))}))}},{key:"render",value:function(){return s.a.createElement("div",{className:"chatWrapper"},s.a.createElement("div",{className:"chat"},s.a.createElement("div",{className:"chatHeader"},s.a.createElement("span",null,"Group Chat")),s.a.createElement("div",{className:"messagesAreaWrapper"},s.a.createElement("div",{className:"messagesArea"},this.renderChat())),s.a.createElement("div",{className:"inputArea"},s.a.createElement(N.a,{id:"standard-full-width",placeholder:"Placeholder",margin:"normal",variant:"outlined",InputLabelProps:{shrink:!0},inputRef:this.chatInput,onKeyDown:this.handleKeyDown}),s.a.createElement(W.a,{"aria-label":"send",onClick:this.onMessageSubmit},s.a.createElement($.a,null)))))}}]),a}(n.Component),J=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).checkToken=function(){return function(){return x.apply(this,arguments)}()},n.setAppState=function(){var e=Object(l.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.isAuth,n.setState({isAuth:a}),window.localStorage.setItem("isAuth",a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.logOut=function(){window.localStorage.removeItem("userName"),window.localStorage.removeItem("userEmail"),window.localStorage.removeItem("token"),window.localStorage.removeItem("refreshToken"),window.localStorage.setItem("isAuth",!1),n.setState({isAuth:!1})},n.componentDidMount=function(){n.setState({isAuth:window.localStorage.getItem("isAuth")||!1})},n.state={isAuth:!1},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"App"},s.a.createElement(f.a,{position:"static"},s.a.createElement(w.a,null,s.a.createElement(v.a,{className:"checkTokenBtn",variant:"contained",onClick:this.checkToken},"Refresh Access Token"),("true"===this.state.isAuth||!0===this.state.isAuth)&&s.a.createElement(v.a,{color:"inherit",onClick:this.logOut},"Log out"))),s.a.createElement(d.a,null,"true"===this.state.isAuth||!0===this.state.isAuth?s.a.createElement(g.a,{to:"/chat"}):s.a.createElement(g.a,{to:"/signup"}),s.a.createElement(g.d,null,s.a.createElement(g.b,{exact:!0,path:"/signup",component:function(){return s.a.createElement(L,{updateState:e.setAppState})}},s.a.createElement(g.b,{path:"/",component:function(){return s.a.createElement(L,{updateState:e.setAppState})}})),s.a.createElement(g.b,{exact:!0,path:"/chat",component:function(){return console.log(e.state.isAuth),"true"===e.state.isAuth||!0===e.state.isAuth?s.a.createElement(Z,null):s.a.createElement(L,{updateState:e.setAppState})}},s.a.createElement(g.b,{path:"/",component:Z})),s.a.createElement(g.b,{component:function(){return"true"===e.state.isAuth||!0===e.state.isAuth?s.a.createElement(Z,null):s.a.createElement(L,{updateState:e.setAppState})}}))))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[121,1,2]]]);
//# sourceMappingURL=main.140ebc23.chunk.js.map